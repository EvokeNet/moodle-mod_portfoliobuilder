{"version":3,"file":"loadportfolios.min.js","sources":["../src/loadportfolios.js"],"sourcesContent":["/**\n * Add comment js logic.\n *\n * @copyright   2023 World Bank Group <https://worldbank.org>\n * @author      Willian Mano <willianmanoaraujo@gmail.com>\n */\n/* eslint-disable */\ndefine(['jquery', 'core/ajax', 'core/templates'], function($, Ajax, Templates) {\n    var LoadPortfolios = function(courseid, type) {\n        this.courseid = courseid;\n\n        this.type = type;\n\n        this.targetdiv = '#' + this.type + 'portfolio';\n\n        this.controlbutton = document.getElementById(this.type + 'portfolio-tab');\n\n        this.loadItems();\n\n        $('.nav-tabs .nav-link, .nav-pills .nav-link').click(function(event) {\n            this.controlbutton = event.target;\n\n            this.type = event.target.dataset.type;\n\n            this.targetdiv = event.target.dataset.target;\n\n            if (event.target.dataset.loaded === 'false') {\n                this.loadItems();\n            }\n        }.bind(this));\n\n        $('#filter-chapter, #filter-group').change(function() {\n            this.chapter = parseInt($('#filter-chapter').val());\n            this.groupid = parseInt($('#filter-group').val());\n\n            this.loadItemsWithFilters();\n        }.bind(this));\n    }\n\n    LoadPortfolios.prototype.loadItems = function() {\n        const request = Ajax.call([{\n            methodname: 'mod_portfoliobuilder_loadportfolios',\n            args: {\n                courseid: this.courseid,\n                type: this.type\n            }\n        }]);\n\n        request[0].done(function(response) {\n            var data = JSON.parse(response.data);\n\n            this.handleLoadData(data);\n        }.bind(this));\n    };\n\n    LoadPortfolios.prototype.handleLoadData = function(data) {\n        const targetdiv = $(this.targetdiv);\n\n        targetdiv.find('.entry_loading-placeholder').addClass('hidden');\n\n        $.each(data, function(index, value) {\n            Templates.render('mod_portfoliobuilder/portfolio_card', value).then(function(content) {\n                targetdiv.find('.portfolios-area').append(content);\n            });\n        });\n\n        this.controlbutton.dataset.loaded = true;\n    };\n\n    LoadPortfolios.prototype.loadItemsWithFilters = function() {\n        const targetdiv = $('#networkportfolio');\n\n        $(targetdiv.find('.entry_loading-placeholder')).removeClass('hidden');\n\n        const request = Ajax.call([{\n            methodname: 'mod_portfoliobuilder_loadportfolios',\n            args: {\n                courseid: this.courseid,\n                type: this.type,\n                groupid: this.groupid,\n                chapter: this.chapter\n            }\n        }]);\n\n        request[0].done(function(response) {\n            var data = JSON.parse(response.data);\n\n            this.handleLoadDataWithFilters(data);\n        }.bind(this));\n    };\n\n    LoadPortfolios.prototype.handleLoadDataWithFilters = function(data) {\n        const targetdiv = $('#networkportfolio');\n\n        $(targetdiv.find('.entry_loading-placeholder')).addClass('hidden');\n\n        $(targetdiv.find('.portfolios-area')).empty();\n\n        $.each(data, function(index, value) {\n            Templates.render('mod_portfoliobuilder/portfolio_card', value).then(function(content) {\n                targetdiv.find('.portfolios-area').append(content);\n            });\n        });\n\n        this.controlbutton.dataset.loaded = true;\n    };\n\n    LoadPortfolios.prototype.courseid = 0;\n\n    LoadPortfolios.prototype.type = 'team';\n\n    LoadPortfolios.prototype.groupid = 0;\n\n    LoadPortfolios.prototype.chapter = 0;\n\n    LoadPortfolios.prototype.targetdiv = '#teamportfolio';\n\n    LoadPortfolios.prototype.controlbutton = null;\n\n    return {\n        'init': function(courseid, type = 'team') {\n            return new LoadPortfolios(courseid, type);\n        }\n    };\n});\n"],"names":["define","$","Ajax","Templates","LoadPortfolios","courseid","type","this","targetdiv","controlbutton","document","getElementById","loadItems","click","event","target","dataset","loaded","bind","change","chapter","parseInt","val","groupid","loadItemsWithFilters","prototype","call","methodname","args","done","response","data","JSON","parse","handleLoadData","find","addClass","each","index","value","render","then","content","append","removeClass","handleLoadDataWithFilters","empty","init","arguments","length","undefined"],"mappings":"AAOAA,OAAO,sCAAA,CAAC,SAAU,YAAa,mBAAmB,SAASC,EAAGC,KAAMC,WAChE,IAAIC,eAAiB,SAASC,SAAUC,MACpCC,KAAKF,SAAWA,SAEhBE,KAAKD,KAAOA,KAEZC,KAAKC,UAAY,IAAMD,KAAKD,KAAO,YAEnCC,KAAKE,cAAgBC,SAASC,eAAeJ,KAAKD,KAAO,iBAEzDC,KAAKK,YAELX,EAAE,6CAA6CY,MAAM,SAASC,OAC1DP,KAAKE,cAAgBK,MAAMC,OAE3BR,KAAKD,KAAOQ,MAAMC,OAAOC,QAAQV,KAEjCC,KAAKC,UAAYM,MAAMC,OAAOC,QAAQD,OAEF,UAAhCD,MAAMC,OAAOC,QAAQC,QACrBV,KAAKK,WAEb,EAAEM,KAAKX,OAEPN,EAAE,kCAAkCkB,OAAO,WACvCZ,KAAKa,QAAUC,SAASpB,EAAE,mBAAmBqB,OAC7Cf,KAAKgB,QAAUF,SAASpB,EAAE,iBAAiBqB,OAE3Cf,KAAKiB,sBACT,EAAEN,KAAKX,QAmFX,OAhFAH,eAAeqB,UAAUb,UAAY,WACjBV,KAAKwB,KAAK,CAAC,CACvBC,WAAY,sCACZC,KAAM,CACFvB,SAAUE,KAAKF,SACfC,KAAMC,KAAKD,SAIX,GAAGuB,KAAK,SAASC,UACrB,IAAIC,KAAOC,KAAKC,MAAMH,SAASC,MAE/BxB,KAAK2B,eAAeH,KACxB,EAAEb,KAAKX,QAGXH,eAAeqB,UAAUS,eAAiB,SAASH,MAC/C,IAAMvB,UAAYP,EAAEM,KAAKC,WAEzBA,UAAU2B,KAAK,8BAA8BC,SAAS,UAEtDnC,EAAEoC,KAAKN,MAAM,SAASO,MAAOC,OACzBpC,UAAUqC,OAAO,sCAAuCD,OAAOE,MAAK,SAASC,SACzElC,UAAU2B,KAAK,oBAAoBQ,OAAOD,QAC9C,GACJ,IAEAnC,KAAKE,cAAcO,QAAQC,QAAS,GAGxCb,eAAeqB,UAAUD,qBAAuB,WAC5C,IAAMhB,UAAYP,EAAE,qBAEpBA,EAAEO,UAAU2B,KAAK,+BAA+BS,YAAY,UAE5C1C,KAAKwB,KAAK,CAAC,CACvBC,WAAY,sCACZC,KAAM,CACFvB,SAAUE,KAAKF,SACfC,KAAMC,KAAKD,KACXiB,QAAShB,KAAKgB,QACdH,QAASb,KAAKa,YAId,GAAGS,KAAK,SAASC,UACrB,IAAIC,KAAOC,KAAKC,MAAMH,SAASC,MAE/BxB,KAAKsC,0BAA0Bd,KACnC,EAAEb,KAAKX,QAGXH,eAAeqB,UAAUoB,0BAA4B,SAASd,MAC1D,IAAMvB,UAAYP,EAAE,qBAEpBA,EAAEO,UAAU2B,KAAK,+BAA+BC,SAAS,UAEzDnC,EAAEO,UAAU2B,KAAK,qBAAqBW,QAEtC7C,EAAEoC,KAAKN,MAAM,SAASO,MAAOC,OACzBpC,UAAUqC,OAAO,sCAAuCD,OAAOE,MAAK,SAASC,SACzElC,UAAU2B,KAAK,oBAAoBQ,OAAOD,QAC9C,GACJ,IAEAnC,KAAKE,cAAcO,QAAQC,QAAS,GAGxCb,eAAeqB,UAAUpB,SAAW,EAEpCD,eAAeqB,UAAUnB,KAAO,OAEhCF,eAAeqB,UAAUF,QAAU,EAEnCnB,eAAeqB,UAAUL,QAAU,EAEnChB,eAAeqB,UAAUjB,UAAY,iBAErCJ,eAAeqB,UAAUhB,cAAgB,KAElC,CACHsC,KAAQ,SAAS1C,UACb,OAAO,IAAID,eAAeC,SADC2C,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,OAElC,EAER"}