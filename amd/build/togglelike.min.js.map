{"version":3,"file":"togglelike.min.js","sources":["../src/togglelike.js"],"sourcesContent":["/* eslint-disable */\r\n\r\n/**\r\n * Add comment js logic.\r\n *\r\n * @package\r\n * @subpackage mod_portfoliobuilder\r\n * @copyright  2021 World Bank Group <https://worldbank.org>\r\n * @author     Willian Mano <willianmanoaraujo@gmail.com>\r\n */\r\n\r\ndefine(['jquery', 'core/ajax', 'mod_portfoliobuilder/sweetalert'], function($, Ajax, Swal) {\r\n    var ToggleLike = function() {\r\n        this.registerEventListeners();\r\n    };\r\n\r\n    ToggleLike.prototype.registerEventListeners = function() {\r\n        $(document).on('click', '.likebutton', function(event) {\r\n            var entrydiv = $(event.currentTarget).closest('.entry');\r\n\r\n            if (entrydiv.length === 0 || entrydiv.length > 1) {\r\n                this.showToast('error', 'Error trying to find the discussion for this comment.');\r\n\r\n                return;\r\n            }\r\n\r\n            var id = entrydiv.data('id');\r\n\r\n            var request = Ajax.call([{\r\n                methodname: 'mod_portfoliobuilder_togglereaction',\r\n                args: {\r\n                    entryid: id,\r\n                    reactionid: 1\r\n                }\r\n            }]);\r\n\r\n            request[0].done(function(data) {\r\n                var likebutton = entrydiv.find('.actions .likebutton');\r\n                var totalreactionsspan = entrydiv.find('.actions .likebutton .totalreactions');\r\n\r\n                totalreactionsspan.empty();\r\n\r\n                likebutton.toggleClass('hasreacted');\r\n\r\n                if (data.message == false || data.message == 'false') {\r\n                    return;\r\n                }\r\n\r\n                totalreactionsspan.text(data.message);\r\n            }.bind(this)).fail(function(error) {\r\n                var message = error.message;\r\n\r\n                if (!message) {\r\n                    message = error.error;\r\n                }\r\n\r\n                this.showToast('error', message);\r\n            }.bind(this));\r\n        }.bind(this));\r\n    };\r\n\r\n    ToggleLike.prototype.showToast = function(type, message) {\r\n        var Toast = Swal.mixin({\r\n            toast: true,\r\n            position: 'top-end',\r\n            showConfirmButton: false,\r\n            timer: 8000,\r\n            timerProgressBar: true,\r\n            onOpen: (toast) => {\r\n                toast.addEventListener('mouseenter', Swal.stopTimer);\r\n                toast.addEventListener('mouseleave', Swal.resumeTimer);\r\n            }\r\n        });\r\n\r\n        Toast.fire({\r\n            icon: type,\r\n            title: message\r\n        });\r\n    };\r\n\r\n    return {\r\n        'init': function() {\r\n            return new ToggleLike();\r\n        }\r\n    };\r\n});\r\n"],"names":["define","$","Ajax","Swal","ToggleLike","registerEventListeners","prototype","document","on","event","entrydiv","currentTarget","closest","length","showToast","id","data","call","methodname","args","entryid","reactionid","done","likebutton","find","totalreactionsspan","empty","toggleClass","message","text","bind","this","fail","error","type","mixin","toast","position","showConfirmButton","timer","timerProgressBar","onOpen","addEventListener","stopTimer","resumeTimer","fire","icon","title"],"mappings":"AAWAA,yCAAO,CAAC,SAAU,YAAa,oCAAoC,SAASC,EAAGC,KAAMC,UAC7EC,WAAa,gBACRC,iCAGTD,WAAWE,UAAUD,uBAAyB,WAC1CJ,EAAEM,UAAUC,GAAG,QAAS,cAAe,SAASC,WACxCC,SAAWT,EAAEQ,MAAME,eAAeC,QAAQ,aAEtB,IAApBF,SAASG,QAAgBH,SAASG,OAAS,OACtCC,UAAU,QAAS,kEAKxBC,GAAKL,SAASM,KAAK,MAETd,KAAKe,KAAK,CAAC,CACrBC,WAAY,sCACZC,KAAM,CACFC,QAASL,GACTM,WAAY,MAIZ,GAAGC,KAAK,SAASN,UACjBO,WAAab,SAASc,KAAK,wBAC3BC,mBAAqBf,SAASc,KAAK,wCAEvCC,mBAAmBC,QAEnBH,WAAWI,YAAY,cAEH,GAAhBX,KAAKY,SAAoC,SAAhBZ,KAAKY,SAIlCH,mBAAmBI,KAAKb,KAAKY,UAC/BE,KAAKC,OAAOC,KAAK,SAASC,WACpBL,QAAUK,MAAML,QAEfA,UACDA,QAAUK,MAAMA,YAGfnB,UAAU,QAASc,UAC1BE,KAAKC,SACTD,KAAKC,QAGX3B,WAAWE,UAAUQ,UAAY,SAASoB,KAAMN,SAChCzB,KAAKgC,MAAM,CACnBC,OAAO,EACPC,SAAU,UACVC,mBAAmB,EACnBC,MAAO,IACPC,kBAAkB,EAClBC,OAASL,QACLA,MAAMM,iBAAiB,aAAcvC,KAAKwC,WAC1CP,MAAMM,iBAAiB,aAAcvC,KAAKyC,gBAI5CC,KAAK,CACPC,KAAMZ,KACNa,MAAOnB,WAIR,MACK,kBACG,IAAIxB"}