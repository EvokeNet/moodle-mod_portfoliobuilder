{"version":3,"file":"togglelike.min.js","sources":["../src/togglelike.js"],"sourcesContent":["/**\n * Toggle like js logic.\n *\n * @copyright   2023 World Bank Group <https://worldbank.org>\n * @author      Willian Mano <willianmanoaraujo@gmail.com>\n */\n\n/* eslint-disable */\ndefine(['jquery', 'core/ajax', 'mod_portfoliobuilder/sweetalert'], function($, Ajax, Swal) {\n    var ToggleLike = function() {\n        this.registerEventListeners();\n    };\n\n    ToggleLike.prototype.registerEventListeners = function() {\n        $(document).on('click', '.likebutton', function(event) {\n            var entrydiv = $(event.currentTarget).closest('.entry');\n\n            if (entrydiv.length === 0 || entrydiv.length > 1) {\n                this.showToast('error', 'Error trying to find the discussion for this comment.');\n\n                return;\n            }\n\n            var id = entrydiv.data('id');\n\n            var request = Ajax.call([{\n                methodname: 'mod_portfoliobuilder_togglereaction',\n                args: {\n                    entryid: id,\n                    reactionid: 1\n                }\n            }]);\n\n            request[0].done(function(data) {\n                var likebutton = entrydiv.find('.actions .likebutton');\n                var totalreactionsspan = entrydiv.find('.actions .likebutton .totalreactions');\n\n                totalreactionsspan.empty();\n\n                likebutton.toggleClass('hasreacted');\n\n                if (data.message == false || data.message == 'false') {\n                    return;\n                }\n\n                totalreactionsspan.text(data.message);\n            }.bind(this)).fail(function(error) {\n                var message = error.message;\n\n                if (!message) {\n                    message = error.error;\n                }\n\n                this.showToast('error', message);\n            }.bind(this));\n        }.bind(this));\n    };\n\n    ToggleLike.prototype.showToast = function(type, message) {\n        var Toast = Swal.mixin({\n            toast: true,\n            position: 'top-end',\n            showConfirmButton: false,\n            timer: 8000,\n            timerProgressBar: true,\n            onOpen: (toast) => {\n                toast.addEventListener('mouseenter', Swal.stopTimer);\n                toast.addEventListener('mouseleave', Swal.resumeTimer);\n            }\n        });\n\n        Toast.fire({\n            icon: type,\n            title: message\n        });\n    };\n\n    return {\n        'init': function() {\n            return new ToggleLike();\n        }\n    };\n});\n"],"names":["define","$","Ajax","Swal","ToggleLike","registerEventListeners","prototype","document","on","event","entrydiv","currentTarget","closest","length","showToast","id","data","call","methodname","args","entryid","reactionid","done","likebutton","find","totalreactionsspan","empty","toggleClass","message","text","bind","this","fail","error","type","mixin","toast","position","showConfirmButton","timer","timerProgressBar","onOpen","addEventListener","stopTimer","resumeTimer","fire","icon","title"],"mappings":"AAQAA,yCAAO,CAAC,SAAU,YAAa,oCAAoC,SAASC,EAAGC,KAAMC,UAC7EC,WAAa,gBACRC,iCAGTD,WAAWE,UAAUD,uBAAyB,WAC1CJ,EAAEM,UAAUC,GAAG,QAAS,cAAe,SAASC,WACxCC,SAAWT,EAAEQ,MAAME,eAAeC,QAAQ,aAEtB,IAApBF,SAASG,QAAgBH,SAASG,OAAS,OACtCC,UAAU,QAAS,kEAKxBC,GAAKL,SAASM,KAAK,MAETd,KAAKe,KAAK,CAAC,CACrBC,WAAY,sCACZC,KAAM,CACFC,QAASL,GACTM,WAAY,MAIZ,GAAGC,KAAK,SAASN,UACjBO,WAAab,SAASc,KAAK,wBAC3BC,mBAAqBf,SAASc,KAAK,wCAEvCC,mBAAmBC,QAEnBH,WAAWI,YAAY,cAEH,GAAhBX,KAAKY,SAAoC,SAAhBZ,KAAKY,SAIlCH,mBAAmBI,KAAKb,KAAKY,UAC/BE,KAAKC,OAAOC,KAAK,SAASC,WACpBL,QAAUK,MAAML,QAEfA,UACDA,QAAUK,MAAMA,YAGfnB,UAAU,QAASc,UAC1BE,KAAKC,SACTD,KAAKC,QAGX3B,WAAWE,UAAUQ,UAAY,SAASoB,KAAMN,SAChCzB,KAAKgC,MAAM,CACnBC,OAAO,EACPC,SAAU,UACVC,mBAAmB,EACnBC,MAAO,IACPC,kBAAkB,EAClBC,OAASL,QACLA,MAAMM,iBAAiB,aAAcvC,KAAKwC,WAC1CP,MAAMM,iBAAiB,aAAcvC,KAAKyC,gBAI5CC,KAAK,CACPC,KAAMZ,KACNa,MAAOnB,WAIR,MACK,kBACG,IAAIxB"}