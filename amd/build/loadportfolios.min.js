define("mod_portfoliobuilder/loadportfolios",["jquery","core/ajax","core/templates"],(function($,Ajax,Templates){var LoadPortfolios=function(courseid,type){this.courseid=courseid,this.type=type,this.targetdiv="#"+this.type+"portfolio",this.controlbutton=document.getElementById(this.type+"portfolio-tab"),this.loadItems(),$(".nav-tabs .nav-link, .nav-pills .nav-link").click(function(event){this.controlbutton=event.target,this.type=event.target.dataset.type,this.targetdiv=event.target.dataset.target,"false"===event.target.dataset.loaded&&this.loadItems()}.bind(this)),$("#filter-chapter, #filter-group").change(function(){this.chapter=parseInt($("#filter-chapter").val()),this.groupid=parseInt($("#filter-group").val()),this.loadItemsWithFilters()}.bind(this))};return LoadPortfolios.prototype.loadItems=function(){Ajax.call([{methodname:"mod_portfoliobuilder_loadportfolios",args:{courseid:this.courseid,type:this.type}}])[0].done(function(response){var data=JSON.parse(response.data);this.handleLoadData(data)}.bind(this))},LoadPortfolios.prototype.handleLoadData=function(data){var targetdiv=$(this.targetdiv);targetdiv.find(".entry_loading-placeholder").addClass("hidden"),$.each(data,(function(index,value){Templates.render("mod_portfoliobuilder/portfolio_card",value).then((function(content){targetdiv.find(".portfolios-area").append(content)}))})),this.controlbutton.dataset.loaded=!0},LoadPortfolios.prototype.loadItemsWithFilters=function(){var targetdiv=$("#networkportfolio");$(targetdiv.find(".entry_loading-placeholder")).removeClass("hidden"),Ajax.call([{methodname:"mod_portfoliobuilder_loadportfolios",args:{courseid:this.courseid,type:this.type,groupid:this.groupid,chapter:this.chapter}}])[0].done(function(response){var data=JSON.parse(response.data);this.handleLoadDataWithFilters(data)}.bind(this))},LoadPortfolios.prototype.handleLoadDataWithFilters=function(data){var targetdiv=$("#networkportfolio");$(targetdiv.find(".entry_loading-placeholder")).addClass("hidden"),$(targetdiv.find(".portfolios-area")).empty(),$.each(data,(function(index,value){Templates.render("mod_portfoliobuilder/portfolio_card",value).then((function(content){targetdiv.find(".portfolios-area").append(content)}))})),this.controlbutton.dataset.loaded=!0},LoadPortfolios.prototype.courseid=0,LoadPortfolios.prototype.type="team",LoadPortfolios.prototype.groupid=0,LoadPortfolios.prototype.chapter=0,LoadPortfolios.prototype.targetdiv="#teamportfolio",LoadPortfolios.prototype.controlbutton=null,{init:function(courseid){return new LoadPortfolios(courseid,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"team")}}}));

//# sourceMappingURL=loadportfolios.min.js.map